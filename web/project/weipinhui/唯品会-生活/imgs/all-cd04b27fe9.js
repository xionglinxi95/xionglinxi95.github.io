"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,a,i,o,s=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,o=[],"[object Array]"===Object.prototype.toString.apply(c)){for(i=c.length,n=0;n<i;n+=1)o[n]=str(n,c)||"null";return a=0===o.length?"[]":gap?"[\n"+gap+o.join(",\n"+gap)+"\n"+s+"]":"["+o.join(",")+"]",gap=s,a}if(rep&&"object"==typeof rep)for(i=rep.length,n=0;n<i;n+=1)"string"==typeof rep[n]&&(r=rep[n],a=str(r,c),a&&o.push(quote(r)+(gap?": ":":")+a));else for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(a=str(r,c),a&&o.push(quote(r)+(gap?": ":":")+a));return a=0===o.length?"{}":gap?"{\n"+gap+o.join(",\n"+gap)+"\n"+s+"}":"{"+o.join(",")+"}",gap=s,a}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,a=e[t];if(a&&"object"==typeof a)for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r=walk(a,n),void 0!==r?a[n]=r:delete a[n]);return reviver.call(e,t,a)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(e){e||(e=window.console={log:function(e,t,n,r,a){},info:function(e,t,n,r,a){},warn:function(e,t,n,r,a){},error:function(e,t,n,r,a){}}),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,Array.prototype.concat.apply(n,arguments))}}),"object"==typeof e.log&&(e.log=Function.prototype.call.bind(e.log,e),e.info=Function.prototype.call.bind(e.info,e),e.warn=Function.prototype.call.bind(e.warn,e),e.error=Function.prototype.call.bind(e.error,e)),"groupCollapsed"in e||(e.groupCollapsed=function(t){e.info("\n------------\n"+t+"\n------------")}),"group"in e||(e.group=function(t){e.info("\n------------\n"+t+"\n------------")}),"groupEnd"in e||(e.groupEnd=function(){}),"time"in e||function(){var t={};e.time=function(e){t[e]=(new Date).getTime()},e.timeEnd=function(n){var r=(new Date).getTime(),a=n in t?r-t[n]:0;e.info(n+": "+a+"ms")}}()}(window.console),$(function(){function Renderer(){}var $=jQuery,win=window,doc=document,VIP;VIP=win.VIP=win.VIP||{};var container=$("#specialContent");$.extend(Renderer.prototype,{isInited:!1,nextReloadTime:0,init:function(e){this.config=e.config,this.container=container,this.addMarsRoot(),this.render()},initReload:function(){var e,t=new Date,n=new Date,r=new Date,a=+new Date,i=Math.round(3e5*Math.random());t.setMinutes(0),t.setHours(10),t=+t,n.setMinutes(0),n.setHours(20),n=+n,r.setMinutes(0),r.setHours(10),r=+r+864e5,e=a<t?t+i:a>n?r+i:n+i;setInterval(function(){var t=+new Date;t>e&&location.reload()},1e3)},render:function(){for(var e=this,t=this.config.module_type_id?[this.config]:this.config.data.moduleList,n=t.length-1;n>=0&&!e.checkLastModule(t[n]);n--);$.each(t,function(n,r){e.createModule(r,n),n==t.length-1&&e.handleLast(!0)})},handleLast:function(e){var t='<div id="J_notify_tips" class="notify-tips"></div>';$("body").append(t),$("img.mst-lazy").lazyload({threshold:500,effect:"fadeIn",load:function(){this.removeAttribute("height")}}),this.checkExtraAnchor(),VIP.Communication.dispatch("component-event-broadcast-done")},checkLastModule:function(e){return!("brand"!=e.module_type_id&&"product"!=e.module_type_id&&"haitao"!=e.module_type_id&&"beauty"!=e.module_type_id&&"collect"!=e.module_type_id&&"channel"!=e.module_type_id||!e.extend||"true"!=e.extend.page.isPaging)&&(e.isLast=!0,!0)},createModule:function(config,index){var dom=$("<div>"),moreHtml='<div class="u-loading u-more-btn J_pager_more"></div>',css=""==config.css&&config.style_id?window.config.data.cssList[config.style_id]:config.css,template=""==config.template&&config.style_id?window.config.data.htmlList[config.style_id]:config.template,js=""==config.js&&config.style_id?window.config.data.jsList[config.style_id]:config.js;dom.append(this.getCssString(css)).append(template).appendTo(this.container),config.isLast&&dom.append(moreHtml);try{eval("(function(){return function(dom, config, index){"+js+"}})()").call(dom,dom,config,index)}catch(e){console.log(e.message)}this.initMars(dom,config,index)},getCssString:function(e){return"<style>"+e+"</style>"},addMarsRoot:function(){window.config&&window.config.data.id&&$("head").append('<meta name="mars_root" content="'+window.config.data.id+'" />')},checkExtraAnchor:function(){var e=!!VIP.getQueryString("extra_anchor")&&VIP.getQueryString("extra_anchor"),t=$("[data-anchor-name="+e+"]");e&&t.length&&setTimeout(function(){$("html, body").animate({scrollTop:t.offset().top},200)},100)},initMars:function(e,t,n){var r=window.config;r&&(VIP.Mars.set(e,n),++n,e.on("click","[mst-mars]",{},function(r){var a=$(this),i=$(r.target),o=e.find("[mst-mars]"),s="undefined"==typeof a.attr("mst-mars")?i.parents("[mst-mars]:eq(0)"):a,c=+o.index(s)+1,u=+n+"_"+c,d=VIP.Mars.get(s.attr("mst-mars"),u),p={module:n+"",seq:c+""},l="mst_"+t.module_type_id+"_click";d=$.extend(d,p),console.log(JSON.stringify(d)),Mar.Seed.request(i[0].tagName.toLowerCase(),"click",l,JSON.stringify(d))}))}}),VIP.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null},VIP.loadScript=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.onload=function(){t()},n.src=e,document.body.appendChild(n)},VIP.cookie=function(e,t,n){if("undefined"==typeof t){var r=null;if(document.cookie&&""!=document.cookie)for(var a=document.cookie.split(";"),i=0;i<a.length;i++){var o=jQuery.trim(a[i]);if(o.substring(0,e.length+1)==e+"="){r=decodeURIComponent(o.substring(e.length+1));break}}return r}n=n||{},null===t&&(t="",n.expires=-1);var s="";if(n.expires&&("number"==typeof n.expires||n.expires.toUTCString)){var c;"number"==typeof n.expires?(c=new Date,c.setTime(c.getTime()+24*n.expires*60*60*1e3)):c=n.expires,s="; expires="+c.toUTCString()}var u=n.path?"; path="+n.path:"",d=n.domain?"; domain="+n.domain:"",p=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),s,u,d,p].join("")},VIP.countdown=function(e){var t=new Date(e).getTime()-(new Date).getTime(),n={time:t,day:"00",hour:"00",min:"00",sec:"00"},r="";return t>0&&(r="0"+parseInt(t/1e3%60),n.sec=r.substr(r.length-2),r="0"+parseInt(t/1e3/60%60),n.min=r.substr(r.length-2),r="0"+parseInt(t/1e3/60/60%60),n.hour=r.substr(r.length-2),r="0"+parseInt(t/1e3/60/60/24%60),n.day=r.substr(r.length-2)),n},VIP.link=function(){function e(e,t){t&&"blank"!=t?location.href=e:window.open(e)}var t={};return t.BRAND="//list.vip.com/{brand}.html",t.PRODUCT="//www.vip.com/detail-{brand}-{product}.html",t.SPECIAL="//act.vip.com/{sid}.html",t.go=function(n,r,a){var i,o="all",s=r;switch(r&&"object"==typeof r&&(o=defaultParam.warehouse||"nh",s=r[o]),n){case"special":location.href=t.SPECIAL.replace(/{sid}/g,s);break;case"brand":i=t.BRAND.replace(/{brand}/g,s),e(i,a);break;case"product":var c=s.match(/(\d*)-(\d*)/)[1],u=s.match(/(\d*)-(\d*)/)[2];i=t.PRODUCT.replace(/{brand}/g,c).replace(/{product}/g,u),e(i,a);break;case"url":e(r,a);break;case"index":i="//www.vip.com",location.href=i}},t}(),VIP.stringToDate=function(e){if("undefined"==typeof e)return new Date;if("date"==typeof e)return e;var t=Date.parse(e),n=new Date(t);if(isNaN(n)){e=e.replace(/:/g,"-"),e=e.replace(" ","-"),e=e.replace(".","-");var r=e.split("-");switch(r.length){case 7:n=new Date(r[0],(--r[1]),r[2],r[3],r[4],r[5],r[6]);break;case 6:n=new Date(r[0],(--r[1]),r[2],r[3],r[4],r[5]);break;default:n=new Date(r[0],(--r[1]),r[2])}}return n},VIP.Communication=function(){var e=$(document),t=[];return{dispatch:function(t){e.trigger(t,arguments)},listen:function(n,r){e.on(n,r),t.indexOf(n)===-1&&"component-event-broadcast"!=n&&t.push(n)},getEventList:function(){return t}}}(),VIP.getIdByUrl=function(e,t,n){if(!e||""==e)return 0;var r,a=/(.*\/){0,}([^.]+).*/gi,i=0;return e.indexOf("msp.appvipshop.com")>-1?e.indexOf("/cmstopic/")>-1?i=e.replace(a,"$2"):e.indexOf("/vis/")>-1?(r=/\/pages\/(\d+)\//,i=e.match(r)[1]):e.indexOf("wapid=mzt")>-1&&(i=VIP.getQueryStringByUrl(e,"wapid")):e.indexOf("mst.vip.com")>-1?i=VIP.getQueryStringByUrl(e,"wapid"):e.indexOf("ma.vip.com")>-1?i=VIP.getQueryStringByUrl(e,"wapid"):e.indexOf("viva.vip.com")>-1?i=VIP.getQueryStringByUrl(e,"wapid"):e.indexOf("mzt.vip.com")>-1&&(i=VIP.getQueryStringByUrl(e,"wapid")),i=""==i?0:i},VIP.getConfigValueByKey=function(){if(!window.config)return"";var e=window.config;return $.each(arguments,function(t,n){e=e[n]?e[n]:""}),e},VIP.getQueryStringByUrl=function(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),r=e.split("?")[1];if(r){var a=e.split("?")[1].match(n);if(null!=a)return unescape(a[2])}return""},VIP.initDefaulParam=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),a=t+""+n+r,i=Math.ceil((new Date).getTime()/1e3/300),i=a+""+i,o=this.getQueryString("client"),s=this.getQueryString("warehouse")||VIP.getConfigValueByKey("data","page_data","warehouse")||"VIP_NH",c=3,u=this.getQueryString("area_id"),d=this.getQueryString("mars_cid"),p=this.getQueryString("is_preload"),l=this.getQueryString("newcustomer"),g=this.getQueryString("wap_consumer"),f=this.getQueryString("m"),m=location.href.replace(/&/g,"%@^_"),y=this.getQueryString("user_id"),h=this.getQueryString("extra_tag"),_=this.getQueryString("wapid")||"mst_"+VIP.getConfigValueByKey("data","id"),w=VIP.getConfigValueByKey("data","id"),v=VIP.getConfigValueByKey("data","build_id"),b=VIP.getQueryString("group_id")||VIP.getQueryString("extra_source_id")||VIP.getQueryString("extra_banner")||0,x=VIP.getConfigValueByKey("data","page_data","page_show_type");window.location.search&&"special"!=f&&o||(s=this.cookie("warehouse"),u=this.cookie("m_vip_province"),net="WIFI",d=this.cookie("mars_cid"),p="1",l=0,g=this.cookie("wap_consumer"),y=""),this.defaultParam={verstr:i,client:o,warehouse:s,area_id:u,mars_cid:d,is_preload:p,newcustomer:l,wap_consumer:g,item_id:c,referer_currurl:m,mst_mars:h,wap_id:_,page_id:w,special_id:v,page_show_type:x,extra_banner:b,protocol_version:VIP.getQueryString("protocol_version"),log:[]}},VIP.initDefaulParam(),VIP.Mars={get:function(e,t){var e=e.split("|"),n=this.getTag(e,t),r=VIP.getQueryString("extra_tag")?VIP.getQueryString("extra_tag")+",":"",a=r+n,i={page:encodeURIComponent(document.title),wap_id:VIP.defaultParam.wap_id,special_id:VIP.defaultParam.special_id,banner_id:VIP.defaultParam.extra_banner,tag:a},o=t?t.split("_"):[];if(0==e.length)return i;switch(e[0]){case"brand":i.target_type=e[0],i.target_id=e[1],i.brand_id=e[1],i.brand_rank=t,i.brandtyp="0";break;case"product":i.target_type=e[0],i.target_id=e[2],i.brand_id=e[1],i.goods_id=e[2],i.brand_rank=t,i.brandtyp="1";break;case"url":e[0]&&(i.target_type=e[0]),e[1]&&(i.target_id=VIP.getIdByUrl(e[1]));break;default:e[0]&&(i.target_type=e[0]),e[1]&&(i.target_id=e[1]),o[0]&&(i.module=o[0]),o[1]&&(i.seq=o[1])}return i},set:function(e,t){var n=this,r=e;r&&(++t,r.find("[mst-mars]").each(function(e,r){var a=$(this),i=a.attr("mst-mars")&&a.attr("mst-mars").split("|"),o=t+"_"+(e+1),s=i[0],c=n.getTag(i,o)||"";switch(s){case"brand":i[1]&&a.attr("mars_exposure_sead","special_slide_expose").attr("mars_exposure_module","mst|brands|"+i[1]+"|"+o+"|0");break;case"product":i[1]&&i[2]&&a.attr("mars_exposure_sead","special_slide_expose").attr("mars_exposure_module","mst|products|"+i[1]+"|"+o+"|1|"+i[2]);break;case"url":var u=/^(http(s)?:)?\/\/mst.vip.com/;if(u.test(i[1])){var d=VIP.getQueryStringByUrl(i[1],"extra_banner")||0;d&&a.attr("mars_exposure_sead","special_slide_expose").attr("mars_exposure_module","mst|specials|"+d+"|"+o+"|2")}}a.attr("mst-rank",o),a.attr("mst-tag",c)}))},send:function(e,t,n){var r=VIP.Mars.get(t,n);Mar.Seed.request("mst","click",e,JSON.stringify(r))},getTag:function(e,t){var n=e[0],r=VIP.defaultParam.special_id||0,a=VIP.defaultParam.extra_banner||0,i="",o=(new Date).getTime(),s=a+"_"+r+"_"+t+"_"+o;switch(n){case"brand":i=e[1];break;case"product":i=e[2];break;case"url":i=VIP.getIdByUrl(e[1]);break;case"vis":i=VIP.getIdByUrl(e[1]);break;default:i=e[1]?e[1]:0}return i=s+"_"+i}},VIP.isInSale=function(e){var t=(new Date).getTime(),e=new Date(e).getTime();return!(t<e)},VIP["interface"]={getPmsRe:function(e){return e&&e.length>0?$.ajax({url:"//pmsgw.vip.com/1.0.2/jsonActiveTipsIndex",dataType:"jsonp",data:e}):void console.log("PmsRe接口参数不正确！")},getProductCoupon:function(e){return e&&e.length>0?$.ajax({url:"//act.vip.com/act/index_ajax.php?service=NewCoupon.getAllBatch",dataType:"jsonp",data:e}):void console.log("商品红包接口参数不正确！")},getBrandCoupon:function(e){return e&&e.length>0?$.ajax({url:"//act.vip.com/act/index_ajax.php?service=NewCoupon.bind",dataType:"jsonp",data:e}):void console.log("档期红包接口参数不正确！")},getProductFavorite:function(e){return e&&e.length>0?$.ajax({url:"//myi.vip.com/fav_sku",dataType:"jsonp",data:e}):void console.log("商品收藏接口参数不正确！")},getBrandFavorite:function(e){return e&&e.length>0?$.ajax({url:"//fav.vip.com/api/stats/brand/sn/count",dataType:"jsonp",data:e}):void console.log("档期收藏接口参数不正确！")}},win.renderer=new Renderer,win.config&&win.renderer.init({config:win.config})});